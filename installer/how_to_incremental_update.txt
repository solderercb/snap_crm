  Система обновлений SNAP CRM реализована по инкрементному принципу.

  В этом случае компоненты обновляются по очереди от релиза к релизу и важно чтобы пользователь, пропустивший 
какие-либо обновления, получил их тоже.

  Например, базовый инсталлятор содержит скомпилированные библиотеки Qt, которые изредка могут обновляться.

  Предположим, что в релизе А эти библиотеки были обновлены, а в релизе Б обновлен только исполняемый файл 
программы. Если пользователь пропустит обновление А, то после обновления до релиза Б программа может перестать 
запускаться.

  Настроить загрузку файлов обновления А можно добавив ссылку на репозиторий в файл Updates.xml обновления Б.
    <RepositoryUpdate>
     <Repository action="add" url="https://github.com/solderercb/snap_crm/releases/download/qtlib-5.15.10.x" displayname="qtlibupdate"/>
    </RepositoryUpdate>

   * url также может быть на локальную файловую систему, например "file:///С:/foobar/qtlib-5.15.10.x"

  Также нужно добавить параметр <ForcedUpdate>true</ForcedUpdate>, чтобы за один раз были применены обновление А
и обновление Б.

  Эти параметры нужно добавлять в файл Updates.xml всех следующих релизов, т. к. они не сохраняются в конфигурации 
maintanance.dat, а пользователь может пропустить несколько обновлений.

  Автоматизировать добавление можно с помощью утилиты sed, добавив в batch-файл (в частности 
regular-packages-update.bat) для сборки пакетов команду:
   sed -i "/<PackageUpdate>/i \ <RepositoryUpdate>\r\n  <Repository action=\"add\" url=\"https://github.com/solderercb/snap_crm/releases/download/qtlib-5.15.10.x" displayname=\"qtlibupdate\"/>\r\n </RepositoryUpdate>" %repodir%\Updates.xml

  После очередного обновлении типа А в обновлениях типа Б нужно заменить ссылку на актуальную версию.

  В случае, когда необходимо частичное обновление компонентов (например, в пакете qtlib обновились библиотеки 
mysql), новые файлы нужно оформить как другой пакет и в файле package.xml этого пакета добавить опцию 
<Essential>true</Essential>, чтобы при обновлении выполнилась его автоматическая устанавка. Если этого не 
сделать, то программа после обновления не запустится, будут выводится ошибки о ненайденных библиотеках, поскольку 
maintenancetool сначала удаляет файлы предыдущей версии, а затем копирует файлы из нового.

  Для возможности использовать github.com в качестве сервера загрузок требуется модификация Qt Installer Framework 
(github не поддерживает директории в релизах). Модифицированную версию можно найти у меня в репозиториях.


